---
title: 'SQL elegance: Crafting beautiful queries over real-world datasets'
date: '2023-01-21'
tags: ['sql', 'machine-learning', 'nlp']
draft: false
layout: PostSimple
summary: "Get an exclusive inside look into the technology behind GPT, the state-of-the-art language generation AI. Understand the complex mechanisms that power this innovative tool and see how it is revolutionizing the way we write and communicate. Don't miss out on this informative and captivating read."
---

This blog will be about how I have written SQL queries on a real-world dataset. Before delving deeper into nitty-gritty details, the one thing I think one should comprehend before writing SQL queries is this: 



"Imagine trying to navigate a foreign city without a map. Similarly, attempting to retrieve valuable information from your data without understanding its underlying structure is like trying to find a needle in a haystack. Understanding the data and how it is stored across different tables is the key to unlocking the true power of your data. Without it, you'll wander aimlessly and waste valuable time and resources writing meaningless SQL queries”



So, In short, Understanding the underlying data is the ultimate to being able to write useful SQL queries. 



Without any further ado, let’s get started!



![](https://lh4.googleusercontent.com/oEbP4JUbY3yqLfUa9W3PAw7m9ccx1tsts_vxr58t_NkFbqLnEKVufq5pZFzDm1f1-VQ5BqPRQhcSAd_9sftg5UdNnS1jzuc7p_drdz2IaDoTJZqAgrP7J3Nzs3ZQQbqiCZqGt4AQQR82uO7Srfwcvhc-YlITYWxz-n7YPK6AdWzKN1_KMKI3c5duddxD6g)

Credits: Generated by Midjourney



## Dataset I’ve dealt with



The dataset I’ve exercised on is [120 years of Olympic history: athletes and results](https://www.kaggle.com/datasets/heesoo37/120-years-of-olympic-history-athletes-and-results?resource=download). Basically, this is a historical dataset on the modern Olympic Games, including all the Games from Athens 1896 to Rio 2016 and scraped by [rgriffin](https://www.kaggle.com/heesoo37).



	In a nutshell, it consists of two .csv files. One named “athlete_events.csv” incorporated info about each row corresponds to an individual athlete competing in an individual Olympic event (athlete-events). The file contains 271116 rows and 15 columns. 



![](https://lh3.googleusercontent.com/AFwI13On1ITQmHwn9Ezv4osf9Xawj8hBfHoOdYQtu6i6BNwXRSRiGRqiizqn4PY1V7gnrbyCdabhZL_GeTbj2nj0tgo1rErsx7omFI0xZQdfbRR0cFqfaxRNyuXAbYZpLn6E112MsyrclB0cZqhRk9hPScdMQi6HTj60N4f5ed1cXPCQBieHUhwAhBwdkQ)



Another is named “‘noc_regions.csv” including info about noc and corresponding regions along with notes. The file contains 231 rows and 3 columns.

![](https://lh4.googleusercontent.com/-54mVueOScUi2Z5M8EnVh8eh3G4MKmfj7chvEPbsuWVWC4g-7O0jq0ofoEvqArGRzwlxhYcF_ubB1d0srpXrkteKtI-6EAXc1uDA-UY_It-u75GpVIKxXG2QbRnXTw7UjaZUQ6JT866FfmL7O6xqj6BFOt7L9vYoVBunq6UK_DOMZXzerFHqjA6WY2PJFw)



## Perplexing Problems that Persisted



#### Problem 1: `Please configure the PostgreSQL Binary Path in the Preferences dialog.`



Fixed by setting proper PostgreSQL Binary path (By the way I’ve used PostgreSQL to execute SQL queries). With the help of the files in present in **bin** SQL queries gets executed.



![](https://lh3.googleusercontent.com/vvr8hb6LtxBPrWKbQj2KpPrtXBce7yjlBIqyjzx-Prjteydj8MCwIGuogsCwodP4zBbDXd_2XX_k8kJf3He_VD7lBJ-jPuCmFXmtVjjqkbWWoJH76PEZHjM-LJ2Kv4J-dNySOE1sN7KG_ARQiKygvdlqS3j11LZcFkL-zveT5JQXIK_mfBr_aSyFH4cwUw)



#### Problem 2: CSV file Header error 

![](https://lh3.googleusercontent.com/Wy6fbWXz6BcBQHey-n3pbRnUtjx_lbqa53wI5rFtZk5DJobh5ximLdjY8UVN4tt0mLbi7XawXl2yh1wt_UwbpQbNcPYCk-r5emcRrdWZoD4GN2dvx3_UASQED3TjIay2jMfL3zBJ7NS5mz5TKaHvLtQEV3pJD1YcMw1JJzEIAnlc8pQ5_c5INGsUMm2U6w)



Solved by enabling headers option. Since the CSV file has headers as its first row. 

![](https://lh6.googleusercontent.com/zX0nX2Ux5t2Vh8-ZMQHmiM1-xO53ey7RnRZYYc-VwzR8hLIQFXgQppc72R2tauj9JZ_HnqBjSNoT7TeOlhpePu_fgL1htTkRiQlP7vzyGl7tAs7H-HHxEDgYUUfdfuXcWVccVlpSRfIDG-B02NwKJSG3PSEXfNaUHF4sPUdB2U9Z7JEymossUjcb1a9PQw)




#### Problem 3 :Format error in the CSV files in the field “name”

![](https://lh6.googleusercontent.com/ROcwNz8nNvmywHO4HJAD6Bjy4Rbvk2Bkt-FkPOz2ybBQpbIoqKHFOhuina3xtWYi41NMTSXyJVj8cYRWzcfoF-rkxMwF3M_-3xernkpisNthDCnyu_lbIPF6ThjLy_XyRzWLbrUa09i_UnKHTfeDOGYION3jcVMtkleBSq6VGyyxkGSUHX8lsWyedd-dFg)



Fixed by choosing double quotes (“) as an escape character




![](https://lh3.googleusercontent.com/p5N5zpG7CjUqHgn6FHB1NcCAxmEA9vjfZa7IRFPNE1kfZL-EFR6eG3u9ZOPcVyVjAvOK4l9IUkZ4dJS9Qgo8R_e3QAUMeKXsx5VkNHvfhsESmHa7QtkhNgphWZzqS07LWjIkQPywEp8-6YnAYQr8L7Rrl9nH9AeJenjvKw5jQGtgjHc-8puykVrJTrbd0A)



## Writing SQL Queries

#### Checking the Database we’re currently resided in

```sql SELECT current_database()```

![](https://lh3.googleusercontent.com/oyK7eytArOlxJPwSlqm54sgUhpT8lngD6JJMWBQ4FQ75qbeecl_nzTuFzYsm9CaHAr8C-V2UNwpecfiknBygEs8s5r8RKHfDEqSSl-yALI3ByYPu3G3V4kI-BjJg9CbHbU3q-HwcfRzfg0H-LJVGYowE-MsjWSlkY8MqaPp4fkQrKQqrZqkNcNiAme7-VA)

#### Dropping (if exists) and Creating two tables to load in the csv files

```sql
DROP TABLE IF EXISTS OLYMPICS_HISTORY;
CREATE TABLE IF NOT EXISTS OLYMPICS_HISTORY

(
	id INT,
	name VARCHAR,
	sex VARCHAR,
	age VARCHAR,
	height VARCHAR, 
	weight VARCHAR,
	team VARCHAR,
	noc VARCHAR,
	games VARCHAR,
	year INT,
	season VARCHAR,
	city VARCHAR,
	sport VARCHAR,
	event VARCHAR,
	medal VARCHAR	
);

DROP TABLE IF EXISTS OLYMPIC_COMMITTEES;
CREATE TABLE IF NOT EXISTS OLYMPIC_COMMITTEES
(
	noc VARCHAR,
	region VARCHAR
);
```

